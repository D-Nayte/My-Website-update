import{Fehler_box}from"../exports.min.js";import{liqui_planner as haushaltsbuch}from"../liqui-planner.min.js";export class Eingabeformular{constructor(){this.html=this._html_generieren()}_html_generieren(){let e=document.createElement("section");return e.id="eingabeformular-container",e.innerHTML='    \n        \n    <form id="eingabeformular" action="#" method="get"></form>\n\n    <div class="eingabeformular-zeile">\n        <h1>Neue Einnahme / Ausgabe hinzufügen</h1>\n    </div>\n   \n    <div class="eingabeformular-zeile">\n        <div class="titel-typ-eingabe-gruppe">\n            <label for="titel">Titel</label>\n            <input type="text" id="titel" form="eingabeformular" name="titel" placeholder="z.B. Einkaufen" size="10" title="Titel des Eintrags"  >\n            <input type="radio" id="einnahme" name="typ" value="einnahme" form="eingabeformular" title="Typ des Eintrags">\n            <label for="einnahme" title="Typ des Eintrags">Einnahme</label>\n            <input type="radio" id="ausgabe" name="typ" value="ausgabe" form="eingabeformular" title="Typ des Eintrags" checked>\n            <label for="ausgabe" title="Typ des Eintrags">Ausgabe</label>\n        </div>\n    </div>\n    \n    <div class="eingabeformular-zeile">\n        <div class="betrag-datum-eingabe-gruppe">\n            <label for="betrag">Betrag</label>\n            <input min = ".01" type="number" id="betrag" name="betrag" form="eingabeformular" placeholder="z.B. 10,42" size="10" step="0.01" title="Betrag des Eintrags (max. zwei Nachkommastellen, kein €-Zeichen)"  >\n            <label for="datum">Datum</label>\n            <input type="date" id="datum" name="datum" form="eingabeformular"  size="10" title="Datum des Eintrags" >\n        </div>\n    </div>\n   \n    <div class="eingabeformular-zeile">\n        <button class="standard" type="submit" form="eingabeformular">Hinzufügen</button>\n    </div>',this._absenden_event_hinzufügen(e),e}anzeigen(){let e=document.querySelector("#navigationsleiste");null!==e&&(e.insertAdjacentElement("afterend",this.html),this._datum_aktualisieren())}"_absenden_event_hinzufügen"(e){e.querySelector("#eingabeformular").addEventListener("submit",e=>{e.preventDefault();let t=this._formulardaten_holen(e),a=this._formulardaten_verarbeiten(t),n=this._formulardaten_validieren(a),i=new Fehler_box;0===n.length?(haushaltsbuch.eintrag_hinzufuegen(a),e.target.reset(),i.anzeigen(n),this._datum_aktualisieren()):i.anzeigen(n)})}_formulardaten_holen(e){return{titel:e.target.elements.titel.value,typ:e.target.elements.typ.value,betrag:e.target.elements.betrag.value,datum:e.target.elements.datum.valueAsDate}}_formulardaten_verarbeiten(e){return{titel:e.titel.trim(),betrag:100*parseFloat(e.betrag),typ:e.typ,datum:e.datum}}_formulardaten_validieren(e){let t=[];return""===e.titel&&t.push("Titel"),null===e.typ.match(/^(?:einnahme|ausgabe)$/)&&t.push("Typ"),null===e.datum&&t.push("Datum"),isNaN(e.betrag)&&t.push("Betrag"),t}_datum_aktualisieren(){let e=document.querySelector("#datum");null!==e&&(e.valueAsDate=new Date)}}